Traceback (most recent call last):
  File "/home/runner/.local/lib/python3.10/site-packages/jupyter_cache/executors/utils.py", line 58, in single_nb_execution
    executenb(
  File "/home/runner/.local/lib/python3.10/site-packages/nbclient/client.py", line 1204, in execute
    return NotebookClient(nb=nb, resources=resources, km=km, **kwargs).execute()
  File "/home/runner/.local/lib/python3.10/site-packages/nbclient/util.py", line 84, in wrapped
    return just_run(coro(*args, **kwargs))
  File "/home/runner/.local/lib/python3.10/site-packages/nbclient/util.py", line 62, in just_run
    return loop.run_until_complete(coro)
  File "/usr/lib/python3.10/asyncio/base_events.py", line 649, in run_until_complete
    return future.result()
  File "/home/runner/.local/lib/python3.10/site-packages/nbclient/client.py", line 663, in async_execute
    await self.async_execute_cell(
  File "/home/runner/.local/lib/python3.10/site-packages/nbclient/client.py", line 965, in async_execute_cell
    await self._check_raise_for_error(cell, cell_index, exec_reply)
  File "/home/runner/.local/lib/python3.10/site-packages/nbclient/client.py", line 862, in _check_raise_for_error
    raise CellExecutionError.from_cell_and_msg(cell, exec_reply_content)
nbclient.exceptions.CellExecutionError: An error occurred while executing the following cell:
------------------
chronological_order = chronological_corpus_order(all_metadata)
corpus_colors = dict(zip(chronological_order, CORPUS_COLOR_SCALE))
chronological_order
------------------

[0;31m---------------------------------------------------------------------------[0m
[0;31mKeyError[0m                                  Traceback (most recent call last)
Cell [0;32mIn[8], line 1[0m
[0;32m----> 1[0m chronological_order [38;5;241m=[39m [43mchronological_corpus_order[49m[43m([49m[43mall_metadata[49m[43m)[49m
[1;32m      2[0m corpus_colors [38;5;241m=[39m [38;5;28mdict[39m([38;5;28mzip[39m(chronological_order, CORPUS_COLOR_SCALE))
[1;32m      3[0m chronological_order

File [0;32m~/work/workflow_deployment/workflow_deployment/DCML/tmp_corpus_docs/notebooks/utils.py:81[0m, in [0;36mchronological_corpus_order[0;34m(df, year_column)[0m
[1;32m     76[0m [38;5;28;01mdef[39;00m [38;5;21mchronological_corpus_order[39m(df: pd[38;5;241m.[39mDataFrame, 
[1;32m     77[0m                                year_column: [38;5;28mstr[39m [38;5;241m=[39m [38;5;124m'[39m[38;5;124mcomposed_end[39m[38;5;124m'[39m) [38;5;241m-[39m[38;5;241m>[39m List[[38;5;28mstr[39m]:
[1;32m     78[0m [38;5;250m    [39m[38;5;124;03m"""Expects a dataframe containing ``year_column`` and corpus names in the first index level.[39;00m
[1;32m     79[0m [38;5;124;03m    Returns the corpus names in chronological order[39;00m
[1;32m     80[0m [38;5;124;03m    """[39;00m
[0;32m---> 81[0m     mean_composition_years [38;5;241m=[39m [43mcorpus_mean_composition_years[49m[43m([49m[43mdf[49m[38;5;241;43m=[39;49m[43mdf[49m[43m,[49m[43m [49m[43myear_column[49m[38;5;241;43m=[39;49m[43myear_column[49m[43m)[49m
[1;32m     82[0m     [38;5;28;01mreturn[39;00m mean_composition_years[38;5;241m.[39mindex[38;5;241m.[39mto_list()

File [0;32m~/work/workflow_deployment/workflow_deployment/DCML/tmp_corpus_docs/notebooks/utils.py:74[0m, in [0;36mcorpus_mean_composition_years[0;34m(df, year_column)[0m
[1;32m     69[0m [38;5;28;01mdef[39;00m [38;5;21mcorpus_mean_composition_years[39m(df: pd[38;5;241m.[39mDataFrame, 
[1;32m     70[0m                                   year_column: [38;5;28mstr[39m [38;5;241m=[39m [38;5;124m'[39m[38;5;124mcomposed_end[39m[38;5;124m'[39m) [38;5;241m-[39m[38;5;241m>[39m pd[38;5;241m.[39mSeries:
[1;32m     71[0m [38;5;250m    [39m[38;5;124;03m"""Expects a dataframe containing ``year_column`` and computes its means by grouping on the first index level ('corpus' by default).[39;00m
[1;32m     72[0m [38;5;124;03m    Returns the result as a series where the index contains corpus names and the values are mean composition years.[39;00m
[1;32m     73[0m [38;5;124;03m    """[39;00m
[0;32m---> 74[0m     [38;5;28;01mreturn[39;00m [43mdf[49m[38;5;241;43m.[39;49m[43mgroupby[49m[43m([49m[43mlevel[49m[38;5;241;43m=[39;49m[38;5;241;43m0[39;49m[43m)[49m[43m[[49m[43myear_column[49m[43m][49m[38;5;241m.[39mmean()[38;5;241m.[39msort_values()

File [0;32m~/.local/lib/python3.10/site-packages/pandas/core/groupby/generic.py:1416[0m, in [0;36mDataFrameGroupBy.__getitem__[0;34m(self, key)[0m
[1;32m   1407[0m [38;5;28;01mif[39;00m [38;5;28misinstance[39m(key, [38;5;28mtuple[39m) [38;5;129;01mand[39;00m [38;5;28mlen[39m(key) [38;5;241m>[39m [38;5;241m1[39m:
[1;32m   1408[0m     [38;5;66;03m# if len == 1, then it becomes a SeriesGroupBy and this is actually[39;00m
[1;32m   1409[0m     [38;5;66;03m# valid syntax, so don't raise warning[39;00m
[1;32m   1410[0m     warnings[38;5;241m.[39mwarn(
[1;32m   1411[0m         [38;5;124m"[39m[38;5;124mIndexing with multiple keys (implicitly converted to a tuple [39m[38;5;124m"[39m
[1;32m   1412[0m         [38;5;124m"[39m[38;5;124mof keys) will be deprecated, use a list instead.[39m[38;5;124m"[39m,
[1;32m   1413[0m         [38;5;167;01mFutureWarning[39;00m,
[1;32m   1414[0m         stacklevel[38;5;241m=[39mfind_stack_level(),
[1;32m   1415[0m     )
[0;32m-> 1416[0m [38;5;28;01mreturn[39;00m [38;5;28;43msuper[39;49m[43m([49m[43m)[49m[38;5;241;43m.[39;49m[38;5;21;43m__getitem__[39;49m[43m([49m[43mkey[49m[43m)[49m

File [0;32m~/.local/lib/python3.10/site-packages/pandas/core/base.py:248[0m, in [0;36mSelectionMixin.__getitem__[0;34m(self, key)[0m
[1;32m    246[0m [38;5;28;01melse[39;00m:
[1;32m    247[0m     [38;5;28;01mif[39;00m key [38;5;129;01mnot[39;00m [38;5;129;01min[39;00m [38;5;28mself[39m[38;5;241m.[39mobj:
[0;32m--> 248[0m         [38;5;28;01mraise[39;00m [38;5;167;01mKeyError[39;00m([38;5;124mf[39m[38;5;124m"[39m[38;5;124mColumn not found: [39m[38;5;132;01m{[39;00mkey[38;5;132;01m}[39;00m[38;5;124m"[39m)
[1;32m    249[0m     subset [38;5;241m=[39m [38;5;28mself[39m[38;5;241m.[39mobj[key]
[1;32m    250[0m     ndim [38;5;241m=[39m subset[38;5;241m.[39mndim

[0;31mKeyError[0m: 'Column not found: composed_end'
KeyError: 'Column not found: composed_end'

